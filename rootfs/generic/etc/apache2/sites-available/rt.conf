<IfModule mod_ssl.c>
    <VirtualHost _default_:443>
        LogLevel warn
        ServerAdmin webmaster@localhost
        ErrorLog ${APACHE_LOG_DIR}/ssl-rt-error.log
        CustomLog ${APACHE_LOG_DIR}/ssl-rt-access.log combined
        SSLEngine on
        SSLCertificateFile      /etc/apache2/ssl/cert.pem
        SSLCertificateChainFile /etc/apache2/ssl/ca.pem
        SSLCertificateKeyFile   /etc/apache2/ssl/key.pem

        <FilesMatch "\.(cgi|shtml|phtml|php)$">
                SSLOptions +StdEnvVars
        </FilesMatch>
        <Directory /usr/lib/cgi-bin>
                SSLOptions +StdEnvVars
        </Directory>
        BrowserMatch "MSIE [2-6]" \
                nokeepalive ssl-unclean-shutdown \
                downgrade-1.0 force-response-1.0
        # MSIE 7 and newer should be able to use keepalive
        BrowserMatch "MSIE [17-9]" ssl-unclean-shutdown
        AddDefaultCharset UTF-8

        DocumentRoot "/opt/rt4/share/html"
        <Location />
            # Require all granted
            SetHandler modperl
            PerlResponseHandler Plack::Handler::Apache2
            PerlSetVar psgi_app /opt/rt4/sbin/rt-server

            AuthType Basic
            AuthName "RT"
            AuthBasicProvider ldap
            AuthLDAPRemoteUserIsDN off
            AuthLDAPURL "ldap://int.netways.de/dc=INT,dc=NETWAYS,dc=DE?samAccountName?sub?(objectCategory=person)(ObjectClass=User)"
            AuthLDAPBindDN netways-http@INT.NETWAYS.DE
            AuthLDAPBindPassword Zuriep2w
            require ldap-group CN=net-rt-auth-HTTP,OU=AuthGroups,OU=NETWAYS,OU=NETRZ,OU=NETWAYS,DC=int,DC=netways,DC=de
        </Location>
        <Perl>
            use Plack::Handler::Apache2;
            Plack::Handler::Apache2->preload("/opt/rt4/sbin/rt-server");
        </Perl>
    </VirtualHost>
</IfModule>

<VirtualHost _default_:80>
    LogLevel warn
    ServerAdmin webmaster@localhost
    ErrorLog ${APACHE_LOG_DIR}/rt-error.log
    CustomLog ${APACHE_LOG_DIR}/rt-access.log combined
    AddDefaultCharset UTF-8
    DocumentRoot "/opt/rt4/share/html"
    <Location />
        # Require all granted
        SetHandler modperl
        PerlResponseHandler Plack::Handler::Apache2
        PerlSetVar psgi_app /opt/rt4/sbin/rt-server
    </Location>
    <Perl>
        use Plack::Handler::Apache2;
        Plack::Handler::Apache2->preload("/opt/rt4/sbin/rt-server");
    </Perl>
</VirtualHost>
